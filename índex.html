<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RIFAS LOS COMPAS</title>

<style>
body{
font-family:'Segoe UI',sans-serif;
margin:0;
background:#e9f7e9;
}

/* MENU */
.menu{
display:flex;
justify-content:center;
gap:10px;
padding:15px;
background:#0d47a1;
}

.menu button{
background:white;
color:#0d47a1;
font-weight:bold;
border:none;
padding:10px 20px;
border-radius:8px;
cursor:pointer;
}

.menu button:hover{
background:#ffe082;
}

/* BANNER */
.banner{
background:linear-gradient(135deg,#ffe082,#80deea);
padding:25px;
text-align:center;
}

.banner h1{
font-size:34px;
margin:10px 0;
color:#0d47a1;
}

.precio{
font-size:26px;
color:#d50000;
font-weight:bold;
}

/* CONTENIDO */
.container{
max-width:1000px;
margin:auto;
padding:20px;
}

.card{
background:white;
border-radius:15px;
padding:20px;
}

/* BOLETOS */
.boletos{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(70px,1fr));
gap:10px;
}

.boleto{
padding:14px 6px;
border-radius:12px;
font-weight:bold;
cursor:pointer;
background:#eeeeee;
text-align:center;
white-space:nowrap;
font-size:15px;
box-shadow:0 3px 6px rgba(0,0,0,.15);
position:relative;
transition:all .2s ease;
}

.boleto:hover{
transform:scale(1.05);
}

.boleto.seleccionado{
background:#00c853;
color:white;
}

.boleto.vendido{
background:#ccc;
color:#666;
cursor:not-allowed;
}

.boleto.vendido::after{
content:"‚úñ";
position:absolute;
top:2px;
right:5px;
font-size:12px;
}

/* BOTON */
button{
margin-top:15px;
padding:14px 25px;
border:none;
border-radius:10px;
background:#00c853;
color:white;
font-size:16px;
cursor:pointer;
}

button:disabled{
background:gray;
cursor:not-allowed;
}

/* VENDEDORES */
.vendedor{
background:#f5f5f5;
padding:15px;
border-radius:10px;
margin-top:10px;
}

hr{
margin:20px 0;
}
</style>
</head>

<body>

<!-- MENU -->
<nav class="menu">
<button onclick="mostrarSeccion('rifa')">Inicio</button>
<button onclick="mostrarSeccion('pagos')">Formas de Pago</button>
</nav>

<!-- SECCION RIFA -->
<div id="rifa" class="seccion">

<div class="banner">
<h1>RIFAS LOS COMPAS</h1>
<div class="precio">BOLETO $50</div>
<h2>ü•á $8000</h2>
<h2>ü•à $3000</h2>
<h2>ü•â $1000</h2>
<h2>üèÖ $500</h2>
<h2>üéñÔ∏è $500</h2>
</div>

<div class="container">
<div class="card">

<div class="boletos" id="boletos"></div>

<div>
Boletos: <span id="cantidad">0</span><br>
Total: $<span id="total">0</span>
</div>

<input type="text" id="nombreCliente" placeholder="Tu nombre completo">
<br>
<button id="btnPagar" onclick="pagar()">Finalizar Compra</button>

</div>
</div>
</div>

<!-- SECCION PAGOS -->
<div id="pagos" class="seccion" style="display:none;">
<div class="container">
<div class="card">

<h2>üí≥ Formas de Pago</h2>

<div class="vendedor">
<h3>‚úÖ Luis Alejandro Romero Sebastian</h3>
<p><strong>üì± Tel:</strong> 7421199270</p>
<p><strong>Tarjeta D√©bito BBVA:</strong><br>4152 3140 2646 1213</p>
<p><strong>Cuenta Clave BBVA:</strong><br>012 180 01540607589 1</p>
</div>

<hr>

<div class="vendedor">
<h3>‚úÖ Angel Gabriel Urioste Luciano</h3>
<p><strong>üì± Tel:</strong> 7421292436</p>
<p><strong>Tarjeta D√©bito BBVA:</strong><br>4152 3145 7352 6715</p>
<p><strong>Cuenta Clave BBVA:</strong><br>012 18001575143370 6</p>
</div>

</div>
</div>
</div>

<script>
const PRECIO_BOLETO=50;
const TOTAL_BOLETOS=400;
const URL_SCRIPT="https://script.google.com/macros/s/AKfycbzTOWYzJCyo8by2wIQVea_okYTKMMmzDyJhNWfAEF4l44J9IRqsw-T6JpRNzP7k6fE/exec";

const contenedor=document.getElementById("boletos");
const seleccionados=new Set();
let vendidos=[];

/* CAMBIO DE SECCION */
function mostrarSeccion(id){
document.querySelectorAll(".seccion").forEach(sec=>{
sec.style.display="none";
});
document.getElementById(id).style.display="block";
}

/* CARGA INICIAL */
fetch(URL_SCRIPT)
.then(res=>res.json())
.then(data=>{
vendidos=data;
generarBoletos();
})
.catch(()=>generarBoletos());

/* ACTUALIZACION AUTOMATICA */
setInterval(()=>{
fetch(URL_SCRIPT)
.then(res=>res.json())
.then(data=>{
vendidos=data;
generarBoletos();
});
},10000);

function generarBoletos(){
contenedor.innerHTML="";
for(let i=1;i<=TOTAL_BOLETOS;i++){
const num=i.toString().padStart(4,"0");
const div=document.createElement("div");
div.className="boleto";
div.textContent=num;

if(vendidos.includes(num)){
div.classList.add("vendido");
}else{
if(seleccionados.has(num)){
div.classList.add("seleccionado");
}
div.onclick=()=>toggle(num,div);
}

contenedor.appendChild(div);
}
}

function toggle(num,div){
if(seleccionados.has(num)){
seleccionados.delete(num);
div.classList.remove("seleccionado");
}else{
seleccionados.add(num);
div.classList.add("seleccionado");
}
actualizarResumen();
}

function actualizarResumen(){
document.getElementById("cantidad").textContent=seleccionados.size;
document.getElementById("total").textContent=seleccionados.size*PRECIO_BOLETO;
}

function pagar(){
if(seleccionados.size===0)return alert("Selecciona boletos");

const nombre=document.getElementById("nombreCliente").value.trim();
if(nombre==="")return alert("Escribe tu nombre");

const boletosArray=Array.from(seleccionados);

/* Validar que no est√©n vendidos */
for(let b of boletosArray){
if(vendidos.includes(b)){
alert("Uno de los boletos ya fue vendido. Actualiza la p√°gina.");
return;
}
}

const boton=document.getElementById("btnPagar");
boton.disabled=true;
boton.textContent="Procesando...";

fetch(URL_SCRIPT,{
method:"POST",
body:JSON.stringify({nombre:nombre,boletos:boletosArray})
})
.then(res=>res.json())
.then(()=>{
alert("Boletos apartados correctamente");
seleccionados.clear();
boton.disabled=false;
boton.textContent="Finalizar Compra";

fetch(URL_SCRIPT)
.then(res=>res.json())
.then(data=>{
vendidos=data;
generarBoletos();
});
});
}
</script>

</body>
</html>
